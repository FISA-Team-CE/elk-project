# 우리카드 데이터를 활용한 ELK 프로젝트

> 진행 기간 : 2026.01.15


## 👩🏻‍💻 팀원 소개

| <img src="https://avatars.githubusercontent.com/u/121941036?v=4" width="150" height="150"/> | <img src="https://avatars.githubusercontent.com/u/118096607?v=4" width="150" height="150"/> | <img src="https://avatars.githubusercontent.com/u/80169727?v=4" width="150" height="150"/> | 
| :-----------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------------: |  
|                 류승환<br/>[@Federico-15](https://github.com/Federico-15)                 |                       서가영<br/>[@caminobelllo](https://github.com/caminobelllo)                       |                유동균<br/>[@dbehdrbs0806](https://github.com/dbehdrbs0806)                |   


## ⚙️ 기술 스택
![DuckDB](https://img.shields.io/badge/DuckDB-FFF000?style=for-the-badge&logo=duckdb&logoColor=black)
![Elasticsearch](https://img.shields.io/badge/Elasticsearch-005571?style=for-the-badge&logo=elasticsearch&logoColor=white)
![Kibana](https://img.shields.io/badge/Kibana-005571?style=for-the-badge&logo=kibana&logoColor=white)
![DBeaver](https://img.shields.io/badge/DBeaver-382923?style=for-the-badge&logo=dbeaver&logoColor=white)

#### 1. 데이터 전처리
   - **DuckDB**: 대용량 CSV 데이터를 메모리 효율적으로 처리하기 위한 분석용 DB 엔진
   		- Usage: 결측치(NULL) 처리(COALESCE), 데이터 타입 변환(TRY_CAST), 고객 세그먼트 분류(CASE WHEN) 등 전처리 로직 수행.
   - **SQL**: 데이터 추출 및 가공

#### 2. 시각화 및 분석
   - **Elasticsearch**(@8.19.3): 전처리된 데이터를 인덱싱하여 검색 및 집계 속도 최적화
   - **Kibana**(@8.19.3): 데이터 시각화 및 대시보드 구축

#### 3. 도구 및 환경
   - **DBeaver**: SQL 쿼리 작성, 실행 및 데이터베이스 관리를 위한 툴
   - **CSV**: 원본 데이터(Raw Data) 및 전처리 완료된 데이터(Processed Data) 저장 포맷

#### 4. 협업 도구
   - **Notion & Slack**


<br />

<br/>


## 선정 주제
### 🎯 주제
> 라이프스테이지 기반의 소비 패턴 분석을 통해 잠정 고객 활성화 전략 고안
<img width="608" height="498" alt="스크린샷 2026-01-16 오전 9 56 00" src="https://github.com/user-attachments/assets/7a2c6ec9-535e-4984-a3e6-5775f3177797" />


### 💡 주제 선정 이유
- 소비의 주축이 되는 4060 세대를 라이프스테이지별로 분류해 실제 결제 패턴을 기반으로 타겟 고객 클러스터를 구성
- 데이터를 통해 지출 분야의 변화가 생기는 시점을 파악해 이에 맞는 타겟팅 전략을 수립해 잠재 고객을 충성 고객으로 전환시키는 인사이트를 도출하고자 함

<br />

<hr/>


## DuckDB를 통한 데이터 전처리
우리카드의 대용량 데이터 (약 900만 건)를 효율적으로 처리하기 위해 DuckDB를 활용하였으며, 효율적인 분석을 위해 다음과 같은 전처리 과정을 거침

<img width="620" height="364" alt="스크린샷 2026-01-16 오전 9 57 48" src="https://github.com/user-attachments/assets/0e72cf4b-9b4b-409e-b9b1-04074d5c97dd" />


### ⚒️ 주요 전처리 과정
> `COPY`를 통한 데이터 분할

> 실제 컬럼명은 표기하지 않음
```sql
-- 라이프스테이지별 잠정 고객 분류
COPY (
    SELECT
    ...
        (
        	COALESCE(대분류컬럼명, 0) + 
        	COALESCE(대분류컬럼명, 0) + 
        	...
        	COALESCE(대분류컬럼명, 0)
        ) AS 대분류_금액합계,

        CASE 
            WHEN (
              COALESCE(대분류컬럼명, 0) + 
        	    COALESCE(대분류컬럼명, 0) + 
        	    ...
        	    COALESCE(대분류컬럼명, 0)
            ) < 150 THEN 'Low_잠정고객'
            WHEN (
              COALESCE(대분류컬럼명, 0) + 
        	    COALESCE(대분류컬럼명, 0) + 
        	    ...
        	    COALESCE(대분류컬럼명, 0)
            ) < 300 THEN 'Mid_일반고객'
            ELSE 'High_충성고객'
        END AS usage_segment,
    ...
```

```sql
-- 시니어
COPY (
    SELECT
        
		..
        CASE 
    	
    	-- 학원비 + 식비
    		WHEN TRY_CAST(연령대컬럼명 AS INTEGER) BETWEEN 40 AND 55
         		AND COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) > 0 
         		AND COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) > 10 
    		THEN '학원비+식비 클러스터'  

    		-- 학원비만 
    		WHEN TRY_CAST(연령대컬럼명 AS INTEGER) BETWEEN 40 AND 65 
         		AND COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) > 0 
    		THEN '학원 클러스터'     
    		
    		WHEN TRY_CAST(연령대컬럼명 AS INTEGER) >= 55 
         		AND ( 
             		COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) > 0  
             			OR 
             		COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) > 5 
         		)
    		THEN '시니어 클러스터'
    		ELSE '기타'	
		END AS 타겟_클러스터,

        -- 분석용 상세 금액 
        COALESCE(TRY_CAST(중분류컬럼명 AS BIGINT), 0) AS 학원비_상세,
        COALESCE(TRY_CAST(중분류컬럼명 AS BIGINT), 0) AS 병원비_상세,

        COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) AS 교육_전체,   -- 교육 전체
        COALESCE(TRY_CAST(대분류컬럼명 AS BIGINT), 0) AS 의료_전체,   -- 의료 전체

        -- 총 이용금액
        (
            COALESCE(대분류컬럼명, 0) + 
            COALESCE(대분류컬럼명, 0) + 
            ...
            COALESCE(대분류컬럼명, 0)
        ) AS 총_이용금액

    ...
```
#### 1. 결측치(NULL) 및 타입 핸들링
  - `COALESCE`와 `TRY_CAST` 함수를 사용하여 NULL 값을 0으로 치환
  - 문자열로 기재된 수치 데이터를 변환하여 연산 오류를 방지
#### 2. 고객 세그멘테이션
  - 단순 이용 금액 합계가 아닌 대분류와 중분류를 활용한 소비 패턴에 따라 고객들을 클러스터링 

<br />

<hr/>


## Kibana를 이용한 데이터 시각화
전처리된 데이터를 Elasticsearch에 적재하고, Kibana Dashboard를 통해 지표들을 시각화함

### 📊 대시보드 구성
#### 1. 라이프스테이지별 잠정 고객 비율 (Stacked Bar Chart)
  - 전체 고객들을 라이프스테이지에 따라 구분
  - 총 이용 금액 150만원 미만을 **Low (잠정 고객)** 으로 정의하여 해당 비율이 가장 높은 그룹을 타켓 페르소나로 선정
<img width="1874" height="548" alt="image" src="https://github.com/user-attachments/assets/83b98d67-220f-4af9-97c9-52a19c6f87cf" />

  <img width="550" height="317" alt="스크린샷 2026-01-16 오전 10 00 31" src="https://github.com/user-attachments/assets/4f5077fe-eeed-4a3d-a615-0d4787a794d0" />

  - 사람수로 정렬했을 때 상위 두 라이프스테이지 '중년기타' 중 잠정 고객의 비율은 약 38.4%, '2nd life' 중 잠정 고객 비율은 46.8%
      - 따라서 중장년층 타겟 페르소나로 선정하여 해당 페르소나의 잠정 고객 그룹에 대한 분석을 진행

<br/>

#### 2. 교육 카테고리 심층 분석 (Unstacked Bar Chart)
  - 연령대는 타겟 페르소나에 맞춰 40-65(40세-69세)로 필터링
  - 대분류인 '사무/서적/학원' 비용 중 실질적인 '학원비(중분류)'의 비중을 분석
<img width="1046" height="591" alt="image" src="https://github.com/user-attachments/assets/65d1dd06-7454-467a-bbf0-fa24850a5427" />

  <img width="554" height="191" alt="스크린샷 2026-01-16 오전 10 01 53" src="https://github.com/user-attachments/assets/8e30b0a2-cafd-4108-80df-9affe7cb4d2a" />

  - 발견점 : '사무통신/서적/학원' 대분류의 약 90%가 학원비임을 규명해 타겟팅의 정당성 확보

<br/>

#### 3. 4060 세대별 지출 변화 추이 (Stacked Bar Chart)
  - 연령대별(x축) 총 이용 금액(y축)을 타겟 페르소나별로 다른 색상을 사용해 시각화
<img width="1876" height="455" alt="image" src="https://github.com/user-attachments/assets/e05db724-9417-4961-9893-5d2e7a267aaa" />

  - 발견점 : 연령대 55(55-59세)를 기점으로 '교육비 지출'이 급감하고, '병원비' 지출이 급증하는 **cross-over point**를 발견
  - 따라서 전체적인 타겟 페르소나에게 교육비 & 병원비에 관한 혜택을 통해 잠정 고객 유치에 적용할 수 있을 것이라 판단

<hr/>

### 💸 마케팅 인사이트 및 전략 도출
> 시각화 데이터를 통해 잠정 고객 유치를 위한 실행 전략을 도출

<img width="838" height="424" alt="스크린샷 2026-01-16 오전 10 08 27" src="https://github.com/user-attachments/assets/746668d7-3c38-401f-943c-9d28ae2f9134" />

#### 1. 4050을 위한 학원비 할인 전략
- 인사이트 : 데이터 분석 결과, 4050 그룹의 '사무통신/서적/학원' 분류에 대한 지출 대부분은 '학원'에 집중되어 있음
- 전략 : 해당 연령대에서 실효성이 낮은 서적 할인을 없애고, '학원비 집중 할인' 혜택을 제공해 자녀를 둔 부모들의 메인 카드 이용을 유도
- 기대 효과 :
  1. 고정비 자동 결제 : 매달 고정적으로 지출되는 학원비를 결제
  2. 마케팅 비욜 효율화 : 해당 대분류에서 이용률이 낮은 서적 및 사무통신에 대한 예산을 삭감하고, 핵심적인 지출인 학원비에 집중하여 비용 대비 효용을 극대화

#### 2. 55+를 위한 시니어 전략
- 인사이트 : 55 (55세~59세) 구간에서 '보험 및 병원'에 대한 지출 비율이 크게 증가하는 것을 확인
- 전략 : 종합 검진 우대, 병원비 청구 할인 등의 헤택이 담인 헬스케어 특화 카드로 교체 발급을 유도
- 기대 효과 :
  1. 고객 이탈 방지 : 기존에 교육비 등의 지출에 카드를 이용했던 경우, 자녀 교육비 지출 종료와 함께 카드를 해지하는 경우가 있을 수 있음. 하지만 고객에게 새로운 사용 명분을 제공하여 타 카드사로의 이탈을 방지
  2. 장기 고객군 확보 : 청년층에 비해 구매력이 높은 시니어층을 확보하여 고령화 시대에 맞는 장기 우량 고객군 확보 가능
  3. 고객 단가 유지 : 비교적으로 결제 단위가 큰 병원비나 종합 검진비 결제를 유치 가능


---
### 📊 대시보드 2. 장기 가입 소액 이용자의 지출 행태 분석

라이프스테이지 분석 외에도, 우리카드를 오랫동안 보유하고 있으나 이용 금액이 저조한 고객층을 타겟팅하여 구체적인 지출 패턴을 분석함

#### 1-1. 결제 수단별 이용 비중 (신용카드 vs 체크카드)

- **대상**: 2010년 이전 가입자 중 월 이용 금액 30만 원 미만 고객

<img width="1876" height="455" alt="image" src="https://github.com/user-attachments/assets/ff502c08-2943-44ef-b0e3-d7749dbbd3cf" />

- **발견점**: 장기 가입 소액 이용자들은 체크카드보다 **신용카드**를 사용하는 비중이 약 2.5배 이상 압도적으로 높게 나타남
- **인사이트**: 소액 이용자임에도 신용카드를 선호한다는 것은 신용카드 고유의 포인트 적립이나 부가 혜택을 선별적으로 이용하는 **'실속형 체리피커'** 성향이 강함을 시사
- **전략**: 이들을 위해 '서브 카드로 사용해도 혜택 체감이 큰' 맞춤형 신용카드 프로모션을 제공한다면 주력 카드 전환 및 이용 금액 증대를 기대할 수 있음

#### 1-2. 업종별 지출 비율 분석 (Top Categories)

- **주요 소비 업종**: 유통, 요식업, 보험/병원, 자동차/연료

<img width="1067" height="531" alt="image" src="https://github.com/user-attachments/assets/4345ab96-42fb-4367-9e86-8e447f6ccbed" />

- **발견점**: 장기 가입 소액 이용자들의 지출 비율 중 **'유통(마트/백화점)'** 및 **'유통영업리'** 업종이 가장 높은 비중을 차지함
- **인사이트**: 이들은 광범위한 소비보다 생필품 구매나 정기적인 의료 서비스 이용 등 **필수 생활 동선**에만 우리 카드를 집중적으로 사용하고 있음
- **활성화 방안**:
    1. **리텐션 확보**: 가장 높은 지출 비율을 보이는 유통 및 생활 필수 영역에 대한 상시 할인 혜택을 강화하여 카드 이용 동기 부여
    2. **고객 이탈 방지**: 중장년층 가입자가 많은 특성을 고려하여 병원 및 보험료 자동이체 혜택을 연계한다면 잠재적인 고객 이탈을 방지하고 충성도를 높일 수 있을 것으로 기대

<hr/>

#### 2. 데이터 분석의 한계 및 가설 검증 실패 사례

분석 과정에서 특정 페르소나를 도출하기 위한 가설을 수립하였으나, 데이터의 해상도 한계로 인해 실패한 사례를 공유함

#### ❌ 실패 가설: 직주 분리(이동자) 페르소나 분석

- **가설**: 거주지와 소비 지역이 다른 '장거리 출퇴근자'는 이동 중 OTT 이용 및 교통비 혜택에 민감할 것이다.
- **가설 내용**: 이동 시간 소요가 많은 회원을 대상으로 배달비, 편의점, OTT 구독, 교통비/주유비 할인 혜택이 유효할 것으로 가정함
- **검증 과정**: 거주지(`HOUS_SIDO_NM`) 필드와 실제 소비가 발생한 가맹점 소재지 데이터를 대조하여 이동 패턴 분석 시도
- **실패 사유**: 현재 데이터의 지리적 해상도가 **'시/도' 단위**로만 구분되어 있어, 동일 지역 내에서의 구체적인 직주 분리 여부를 판별하기에는 데이터가 모호함
- **교훈**: 현재 데이터 구조로는 지리적 차이를 유의미하게 분석할 수 없음을 확인하여 해당 가설을 기각함

<img width="600" height="400" alt="image" src="https://github.com/user-attachments/assets/5af3d0db-8c15-42c2-9258-e673c5cb3d6d" />

<hr/>

### 💸 마케팅 인사이트 및 전략 도출 2

시각화 데이터를 통해 잠정 고객 유치를 위한 실행 전략을 도출

### 1. 장기 가입 소액 고객을 위한 실속형 신용카드 전략

- **인사이트**: 장기 가입 소액 이용자들은 이용 금액은 적지만, 체크카드보다 신용카드 이용 비중이 **2.5배 이상** 높으며, 지출의 대부분이 **유통(마트/백화점) 및 생활 필수 업종**에 집중되어 있음.

- **전략**: '서브 카드'로 활용 중인 이들에게 실질적인 체감 혜택이 큰 **유통 및 생활 밀착형 특화 프로모션**을 제공하여 메인 카드 전환을 유도함.

- **기대 효과**:
    1. **메인 카드화(Up-selling)**: 소액이라도 신용카드를 선호하는 '체리피커' 성향을 공략하여, 생활 필수 업종 결제 시 포인트 적립률을 높여 주력 카드로의 사용 빈도 확대를 유도함.
    2. **리텐션(Retention) 강화**: 장기 가입자들의 주된 소비 처인 유통 및 의료 분야에 대한 상시 할인 혜택을 강화함으로써, 경쟁사 카드로의 이탈을 방지하고 충성도를 제고함.
    3. **고정 지출 유치**: 중장년층 비중이 높은 특성을 고려하여 병원비나 보험료 등 고정적인 대액 결제를 우리 카드로 유도하여 고객당 평균 결제 금액(ARPU) 상승을 기대함.

### 2. 데이터 기반 페르소나 재정의 및 타겟팅 정교화

- **인사이트**: 초기 가설이었던 '장거리 이동자' 페르소나는 데이터 해상도 한계로 기각되었으나, 분석을 통해 이들이 **'집 근처 마트와 병원을 이용하는 실속파'**라는 실제 페르소나를 발견함.

- **전략**: 위치 기반의 모호한 혜택(OTT, 교통비 등) 보다는 **거주지 중심의 생활 밀착형 혜택**으로 마케팅 자원을 재배치함.

- **기대 효과**:
    1. **마케팅 효율 극대화**: 실효성이 낮은 이동 관련 혜택 예산을 삭감하고, 실제 소비가 일어나는 유통 및 의료 업종에 집중하여 마케팅 비용 대비 효용을 높임.

    2. **데이터 분석의 선순환**: 가설 실패 과정을 통해 파악된 데이터의 한계를 바탕으로, 향후 구 단위 상세 주소 데이터 확보 등 분석 고도화를 위한 명확한 방향성을 수립함.
